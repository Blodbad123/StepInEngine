<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>6.5 Addendum</title><link rel="stylesheet" href="core.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.74.0"/></head><body><div class="sect1" title="6.5 Addendum"><div class="titlepage"><div><div><h1 class="title"><a id="addendum-id4"/>6.5 Addendum</h1></div></div></div><div class="note" title="Note"><h3 class="title">Note</h3><p><span class="emphasis"><em>Sunday, March 30, 2008</em></span></p></div><p>Since the vulnerability was fixed and a new version of avast! is now available, I released a detailed security advisory on my website today.<sup>[<a href="ch06s05.html#ftn.CHP-6-FN-18" class="footnoteref">74</a>]</sup> The bug was assigned CVE-2008-1625. <a class="xref" href="ch06s05.html#timeline_from_vendor_notification_to_the" title="Figure 6-9. Timeline from vendor notification to the release of my security advisory">Figure 6-9</a> shows the timeline of the vulnerability fix.<a id="IDX-CHP-6-0046" class="indexterm"/></p><div class="figure"><a id="timeline_from_vendor_notification_to_the"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject6_d1e7474"/><img src="httpatomoreillycomsourcenostarchimages939321.png.jpg" alt="Timeline from vendor notification to the release of my security advisory"/></div></div><p class="title">Figure 6-9. Timeline from vendor notification to the release of my security advisory</p></div><div class="sect2" title="Notes"><div class="titlepage"><div><div><h2 class="title"><a id="notes-id5"/>Notes</h2></div></div></div><p><sup>[<a id="CHP-6-FN-1" href="#ftn.CHP-6-FN-1" class="footnote">57</a>]</sup></p><p><sup>[<a id="CHP-6-FN-2" href="#ftn.CHP-6-FN-2" class="footnote">58</a>]</sup></p><p><sup>[<a id="CHP-6-FN-3" href="#ftn.CHP-6-FN-3" class="footnote">59</a>]</sup></p><p><sup>[<a id="CHP-6-FN-4" href="#ftn.CHP-6-FN-4" class="footnote">60</a>]</sup></p><p><sup>[<a id="CHP-6-FN-5" href="#ftn.CHP-6-FN-5" class="footnote">61</a>]</sup></p><p><sup>[<a id="CHP-6-FN-6" href="#ftn.CHP-6-FN-6" class="footnote">62</a>]</sup></p><p><sup>[<a id="CHP-6-FN-7" href="#ftn.CHP-6-FN-7" class="footnote">63</a>]</sup></p><p><sup>[<a id="CHP-6-FN-8" href="#ftn.CHP-6-FN-8" class="footnote">64</a>]</sup></p><p><sup>[<a id="CHP-6-FN-9" href="#ftn.CHP-6-FN-9" class="footnote">65</a>]</sup></p><p><sup>[<a id="CHP-6-FN-10" href="#ftn.CHP-6-FN-10" class="footnote">66</a>]</sup></p><p><sup>[<a id="CHP-6-FN-11" href="#ftn.CHP-6-FN-11" class="footnote">67</a>]</sup></p><p><sup>[<a id="CHP-6-FN-12" href="#ftn.CHP-6-FN-12" class="footnote">68</a>]</sup></p><p><sup>[<a id="CHP-6-FN-13" href="#ftn.CHP-6-FN-13" class="footnote">69</a>]</sup></p><p><sup>[<a id="CHP-6-FN-14" href="#ftn.CHP-6-FN-14" class="footnote">70</a>]</sup></p><p><sup>[<a id="CHP-6-FN-15" href="#ftn.CHP-6-FN-15" class="footnote">71</a>]</sup></p><p><sup>[<a id="CHP-6-FN-16" href="#ftn.CHP-6-FN-16" class="footnote">72</a>]</sup></p><p><sup>[<a id="CHP-6-FN-17" href="#ftn.CHP-6-FN-17" class="footnote">73</a>]</sup></p><p><sup>[<a id="CHP-6-FN-18" href="#ftn.CHP-6-FN-18" class="footnote">74</a>]</sup><a id="IDX-CHP-6-0047" class="indexterm"/></p></div><div class="footnotes"><br/><hr/><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-1" href="#CHP-6-FN-1" class="para">57</a>] </sup>See SANS Top 20 Internet Security Problems, Threats and Risks (2007 Annual Update), <a class="ulink" href="http://www.sans.org/top20/2007/">http://www.sans.org/top20/2007/</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-2" href="#CHP-6-FN-2" class="para">58</a>] </sup>See <a class="ulink" href="http://www.virustotal.com/">http://www.virustotal.com/</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-3" href="#CHP-6-FN-3" class="para">59</a>] </sup>See <a class="ulink" href="http://www.avast.com/">http://www.avast.com/</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-4" href="#CHP-6-FN-4" class="para">60</a>] </sup>See <a class="ulink" href="http://www.vmware.com/">http://www.vmware.com/</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-5" href="#CHP-6-FN-5" class="para">61</a>] </sup>WinDbg, the “official” Windows Debugger from Microsoft, is distributed as part of the free “Debugging Tools for Windows” suite available at <a class="ulink" href="http://www.microsoft.com/whdc/DevTools/Debugging/default.mspx">http://www.microsoft.com/whdc/DevTools/Debugging/default.mspx</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-6" href="#CHP-6-FN-6" class="para">62</a>] </sup>You can find a download link for a vulnerable trial version of avast! Professional 4.7 at <a class="ulink" href="http://www.trapkit.de/books/bhd/">http://www.trapkit.de/books/bhd/</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-7" href="#CHP-6-FN-7" class="para">63</a>] </sup>See <a class="ulink" href="http://www.nirsoft.net/utils/driverview.html">http://www.nirsoft.net/utils/driverview.html</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-8" href="#CHP-6-FN-8" class="para">64</a>] </sup>See <a class="ulink" href="http://www.hex-rays.com/idapro/">http://www.hex-rays.com/idapro/</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-9" href="#CHP-6-FN-9" class="para">65</a>] </sup>See Mark E. Russinovich and David A. Solomon, <span class="emphasis"><em>Microsoft Windows Internals: Microsoft Windows Server 2003, Windows XP, and Windows 2000, 4th ed</em></span>. (Redmond, WA: Microsoft Press, 2005).</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-10" href="#CHP-6-FN-10" class="para">66</a>] </sup>See MSDN Library: Windows Development: Windows Driver Kit: Kernel-Mode Driver Architecture: Reference: Standard Driver Routines: DriverEntry at <a class="ulink" href="http://msdn.microsoft.com/en-us/library/ff544113.aspx">http://msdn.microsoft.com/en-us/library/ff544113.aspx</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-11" href="#CHP-6-FN-11" class="para">67</a>] </sup>WinObj is available at <a class="ulink" href="http://technet.microsoft.com/en-us/sysinternals/bb896657.aspx">http://technet.microsoft.com/en-us/sysinternals/bb896657.aspx</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-12" href="#CHP-6-FN-12" class="para">68</a>] </sup>The Windows Driver Kit can be downloaded at <a class="ulink" href="http://www.microsoft.com/whdc/devtools/WDK/default.mspx">http://www.microsoft.com/whdc/devtools/WDK/default.mspx</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-13" href="#CHP-6-FN-13" class="para">69</a>] </sup>See MSDN Library: Windows Development: Windows Driver Kit: Kernel-Mode Driver Architecture: Reference: Standard Driver Routines: DispatchDeviceControl available at <a class="ulink" href="http://msdn.microsoft.com/en-us/library/ff543287.aspx">http://msdn.microsoft.com/en-us/library/ff543287.aspx</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-14" href="#CHP-6-FN-14" class="para">70</a>] </sup>See MSDN Library: Windows Development: Windows Driver Kit: Kernel-Mode Driver Architecture: Reference: Kernel Data Types: System-Defined Data Structures: IRP available at <a class="ulink" href="http://msdn.microsoft.com/en-us/library/ff550694.aspx">http://msdn.microsoft.com/en-us/library/ff550694.aspx</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-15" href="#CHP-6-FN-15" class="para">71</a>] </sup>See MSDN Library: Windows Development: Windows Driver Kit: Kernel-Mode Driver Architecture: Design Guide: Writing WDM Drivers: Managing Input/Output for Drivers: Handling IRPs: Using I/O Control Codes: Buffer Descriptions for I/O Control Codes available at <a class="ulink" href="http://msdn.microsoft.com/en-us/library/ff540663.aspx">http://msdn.microsoft.com/en-us/library/ff540663.aspx</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-16" href="#CHP-6-FN-16" class="para">72</a>] </sup>See Jamie Butler, <span class="emphasis"><em>DKOM (Direct Kernel Object Manipulation)</em></span> (presentation, Black Hat Europe, Amsterdam, May 2004), at <a class="ulink" href="http://www.blackhat.com/presentations/win-usa-04/bh-win-04-butler.pdf">http://www.blackhat.com/presentations/win-usa-04/bh-win-04-butler.pdf</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-17" href="#CHP-6-FN-17" class="para">73</a>] </sup>See <a class="ulink" href="http://www.trapkit.de/books/bhd/">http://www.trapkit.de/books/bhd/</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-18" href="#CHP-6-FN-18" class="para">74</a>] </sup>My security advisory that describes the details of the avast! vulnerability can be found at <a class="ulink" href="http://www.trapkit.de/advisories/TKADV2008-002.txt">http://www.trapkit.de/advisories/TKADV2008-002.txt</a>.</p></div></div></div></body></html>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>6.5 Addendum</title><link rel="stylesheet" href="core.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.74.0"/></head><body><div class="sect1" title="6.5 Addendum"><div class="titlepage"><div><div><h1 class="title"><a id="addendum-id4"/>6.5 Addendum</h1></div></div></div><div class="note" title="Note"><h3 class="title">Note</h3><p><span class="emphasis"><em>Sunday, March 30, 2008</em></span></p></div><p>Since the vulnerability was fixed and a new version of avast! is now available, I released a detailed security advisory on my website today.<sup>[<a href="ch06s05.html#ftn.CHP-6-FN-18" class="footnoteref">74</a>]</sup> The bug was assigned CVE-2008-1625. <a class="xref" href="ch06s05.html#timeline_from_vendor_notification_to_the" title="Figure 6-9. Timeline from vendor notification to the release of my security advisory">Figure 6-9</a> shows the timeline of the vulnerability fix.<a id="IDX-CHP-6-0046" class="indexterm"/></p><div class="figure"><a id="timeline_from_vendor_notification_to_the"/><div class="figure-contents"><div class="mediaobject"><a id="I_mediaobject6_d1e7474"/><img src="httpatomoreillycomsourcenostarchimages939321.png.jpg" alt="Timeline from vendor notification to the release of my security advisory"/></div></div><p class="title">Figure 6-9. Timeline from vendor notification to the release of my security advisory</p></div><div class="sect2" title="Notes"><div class="titlepage"><div><div><h2 class="title"><a id="notes-id5"/>Notes</h2></div></div></div><p><sup>[<a id="CHP-6-FN-1" href="#ftn.CHP-6-FN-1" class="footnote">57</a>]</sup></p><p><sup>[<a id="CHP-6-FN-2" href="#ftn.CHP-6-FN-2" class="footnote">58</a>]</sup></p><p><sup>[<a id="CHP-6-FN-3" href="#ftn.CHP-6-FN-3" class="footnote">59</a>]</sup></p><p><sup>[<a id="CHP-6-FN-4" href="#ftn.CHP-6-FN-4" class="footnote">60</a>]</sup></p><p><sup>[<a id="CHP-6-FN-5" href="#ftn.CHP-6-FN-5" class="footnote">61</a>]</sup></p><p><sup>[<a id="CHP-6-FN-6" href="#ftn.CHP-6-FN-6" class="footnote">62</a>]</sup></p><p><sup>[<a id="CHP-6-FN-7" href="#ftn.CHP-6-FN-7" class="footnote">63</a>]</sup></p><p><sup>[<a id="CHP-6-FN-8" href="#ftn.CHP-6-FN-8" class="footnote">64</a>]</sup></p><p><sup>[<a id="CHP-6-FN-9" href="#ftn.CHP-6-FN-9" class="footnote">65</a>]</sup></p><p><sup>[<a id="CHP-6-FN-10" href="#ftn.CHP-6-FN-10" class="footnote">66</a>]</sup></p><p><sup>[<a id="CHP-6-FN-11" href="#ftn.CHP-6-FN-11" class="footnote">67</a>]</sup></p><p><sup>[<a id="CHP-6-FN-12" href="#ftn.CHP-6-FN-12" class="footnote">68</a>]</sup></p><p><sup>[<a id="CHP-6-FN-13" href="#ftn.CHP-6-FN-13" class="footnote">69</a>]</sup></p><p><sup>[<a id="CHP-6-FN-14" href="#ftn.CHP-6-FN-14" class="footnote">70</a>]</sup></p><p><sup>[<a id="CHP-6-FN-15" href="#ftn.CHP-6-FN-15" class="footnote">71</a>]</sup></p><p><sup>[<a id="CHP-6-FN-16" href="#ftn.CHP-6-FN-16" class="footnote">72</a>]</sup></p><p><sup>[<a id="CHP-6-FN-17" href="#ftn.CHP-6-FN-17" class="footnote">73</a>]</sup></p><p><sup>[<a id="CHP-6-FN-18" href="#ftn.CHP-6-FN-18" class="footnote">74</a>]</sup><a id="IDX-CHP-6-0047" class="indexterm"/></p></div><div class="footnotes"><br/><hr/><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-1" href="#CHP-6-FN-1" class="para">57</a>] </sup>See SANS Top 20 Internet Security Problems, Threats and Risks (2007 Annual Update), <a class="ulink" href="http://www.sans.org/top20/2007/">http://www.sans.org/top20/2007/</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-2" href="#CHP-6-FN-2" class="para">58</a>] </sup>See <a class="ulink" href="http://www.virustotal.com/">http://www.virustotal.com/</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-3" href="#CHP-6-FN-3" class="para">59</a>] </sup>See <a class="ulink" href="http://www.avast.com/">http://www.avast.com/</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-4" href="#CHP-6-FN-4" class="para">60</a>] </sup>See <a class="ulink" href="http://www.vmware.com/">http://www.vmware.com/</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-5" href="#CHP-6-FN-5" class="para">61</a>] </sup>WinDbg, the “official” Windows Debugger from Microsoft, is distributed as part of the free “Debugging Tools for Windows” suite available at <a class="ulink" href="http://www.microsoft.com/whdc/DevTools/Debugging/default.mspx">http://www.microsoft.com/whdc/DevTools/Debugging/default.mspx</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-6" href="#CHP-6-FN-6" class="para">62</a>] </sup>You can find a download link for a vulnerable trial version of avast! Professional 4.7 at <a class="ulink" href="http://www.trapkit.de/books/bhd/">http://www.trapkit.de/books/bhd/</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-7" href="#CHP-6-FN-7" class="para">63</a>] </sup>See <a class="ulink" href="http://www.nirsoft.net/utils/driverview.html">http://www.nirsoft.net/utils/driverview.html</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-8" href="#CHP-6-FN-8" class="para">64</a>] </sup>See <a class="ulink" href="http://www.hex-rays.com/idapro/">http://www.hex-rays.com/idapro/</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-9" href="#CHP-6-FN-9" class="para">65</a>] </sup>See Mark E. Russinovich and David A. Solomon, <span class="emphasis"><em>Microsoft Windows Internals: Microsoft Windows Server 2003, Windows XP, and Windows 2000, 4th ed</em></span>. (Redmond, WA: Microsoft Press, 2005).</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-10" href="#CHP-6-FN-10" class="para">66</a>] </sup>See MSDN Library: Windows Development: Windows Driver Kit: Kernel-Mode Driver Architecture: Reference: Standard Driver Routines: DriverEntry at <a class="ulink" href="http://msdn.microsoft.com/en-us/library/ff544113.aspx">http://msdn.microsoft.com/en-us/library/ff544113.aspx</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-11" href="#CHP-6-FN-11" class="para">67</a>] </sup>WinObj is available at <a class="ulink" href="http://technet.microsoft.com/en-us/sysinternals/bb896657.aspx">http://technet.microsoft.com/en-us/sysinternals/bb896657.aspx</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-12" href="#CHP-6-FN-12" class="para">68</a>] </sup>The Windows Driver Kit can be downloaded at <a class="ulink" href="http://www.microsoft.com/whdc/devtools/WDK/default.mspx">http://www.microsoft.com/whdc/devtools/WDK/default.mspx</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-13" href="#CHP-6-FN-13" class="para">69</a>] </sup>See MSDN Library: Windows Development: Windows Driver Kit: Kernel-Mode Driver Architecture: Reference: Standard Driver Routines: DispatchDeviceControl available at <a class="ulink" href="http://msdn.microsoft.com/en-us/library/ff543287.aspx">http://msdn.microsoft.com/en-us/library/ff543287.aspx</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-14" href="#CHP-6-FN-14" class="para">70</a>] </sup>See MSDN Library: Windows Development: Windows Driver Kit: Kernel-Mode Driver Architecture: Reference: Kernel Data Types: System-Defined Data Structures: IRP available at <a class="ulink" href="http://msdn.microsoft.com/en-us/library/ff550694.aspx">http://msdn.microsoft.com/en-us/library/ff550694.aspx</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-15" href="#CHP-6-FN-15" class="para">71</a>] </sup>See MSDN Library: Windows Development: Windows Driver Kit: Kernel-Mode Driver Architecture: Design Guide: Writing WDM Drivers: Managing Input/Output for Drivers: Handling IRPs: Using I/O Control Codes: Buffer Descriptions for I/O Control Codes available at <a class="ulink" href="http://msdn.microsoft.com/en-us/library/ff540663.aspx">http://msdn.microsoft.com/en-us/library/ff540663.aspx</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-16" href="#CHP-6-FN-16" class="para">72</a>] </sup>See Jamie Butler, <span class="emphasis"><em>DKOM (Direct Kernel Object Manipulation)</em></span> (presentation, Black Hat Europe, Amsterdam, May 2004), at <a class="ulink" href="http://www.blackhat.com/presentations/win-usa-04/bh-win-04-butler.pdf">http://www.blackhat.com/presentations/win-usa-04/bh-win-04-butler.pdf</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-17" href="#CHP-6-FN-17" class="para">73</a>] </sup>See <a class="ulink" href="http://www.trapkit.de/books/bhd/">http://www.trapkit.de/books/bhd/</a>.</p></div><div class="footnote"><p><sup>[<a id="ftn.CHP-6-FN-18" href="#CHP-6-FN-18" class="para">74</a>] </sup>My security advisory that describes the details of the avast! vulnerability can be found at <a class="ulink" href="http://www.trapkit.de/advisories/TKADV2008-002.txt">http://www.trapkit.de/advisories/TKADV2008-002.txt</a>.</p></div></div></div></body></html>
